{% extends "layouts/main.twig" %}

{% block content %}
    <nav class="nav">
        <a class="nav__btn" href="/">{{ translate.t('ru', 'home') }}</a>
        <a class="nav__btn" href="/products">
            {{ translate.t('ru', 'to products') }}
        </a>
    </nav>

    <hr>
    {% if cartItems != null %}
        <div class="flex space_between">
            <table class="table no_margin">
                <caption>
                    <h3> {{ translate.t('ru', 'cart') }} </h3>
                </caption>
                <thead class="table__head">
                <tr class="head__row">
                    <th class="head__cell">{{ translate.t('ru', 'id') }}</th>
                    <th class="head__cell">{{ translate.t('ru', 'name') }}</th>
                    <th class="head__cell">{{ translate.t('ru', 'price') }}</th>
                    <th class="head__cell">{{ translate.t('ru', 'count') }}</th>
                    <th class="head__cell">{{ translate.t('ru', 'photo') }}</th>
                    <th class="head__cell"></th>
                </tr>
                </thead>
                <tbody>
                {% for item in cartItems %}
                    <tr class="table__row text_center text_bold" data-href="/products/view?id={{ item.id }}">
                        <td class="table__cell">{{ item.id }}</td>
                        <td class="table__cell">{{ item.name }}</td>
                        <td class="table__cell">{{ item.price }} x 1</td>
                        <td class="table__cell">{{ item.count }}</td>
                        <td class="table__cell">
                            <img class="product__photo" src="/assets/{{ item.photo }}" alt="product-photo">
                        </td>
                        <td class="table__cell">
                            <i class="btn delete fas fa-trash" data-href="/{{ controller }}/delete?id={{ item.id }}"> x1 </i>
                            {% if item.count > 1 %}
                                <i class="btn delete fas fa-trash" data-href="/{{ controller }}/delete?id={{ item.id }}&all=true">  All </i>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="form__container">
                <h3 class="text_center">
                    <span>
                    {{ translate.t('ru', 'products in cart') }}
                    </span>
                    <span class="text_marked" >{{ cartTotal['count'] }}</span>
                    <span>
                    {{ translate.t('ru', 'total price') }}
                    </span>
                    <span class="text_marked">{{ cartTotal['price'] }}</span>
                </h3>

                <form class="form" method="post">
                    {% if user != null %}
                        <label for="fio"> {{ translate.t('ru', 'fio') }} </label>
                        {% set fio = user.last_name ~ ' ' ~ user.first_name ~ ' ' ~ user.second_name %}
                        <input id="fio" class="input" type="text" name="fio" value="{{ fio }}">

                        <label for="email"> {{ translate.t('ru', 'email') }} </label>
                        <input id="email" class="input" type="text" name="email" value="{{ user.email }}">

                        <label for="phone"> {{ translate.t('ru', 'phone') }} </label>
                        <input id="phone" class="input" type="number" name="phone" value="{{ user.phone }}">

                        <label for="address"> {{ translate.t('ru', 'address') }} </label>
                        <input id="address" class="input" type="text" name="address">

                        <button class="btn" type="submit">{{ translate.t('ru', 'do order') }}</button>
                    {% else %}
                        <h3 class="text_center text_marked">{{ translate.t('ru', 'to get tour order please login first') }}</h3>
                        <h5 class="text_center text_marked">{{ translate.t('ru', 'click button login on header') }}</h5>
                    {% endif %}
                </form>

            </div>
        </div>

    {% else %}
        <h3 class="text_center"> {{ translate.t('ru', 'cart is empty!') }} </h3>
    {% endif %}
{% endblock %}